{"version":3,"sources":["webpack:///webpack/bootstrap 54ea09be0548ee64f76e","webpack:///external \"inversify\"","webpack:///external \"inversify-express-utils\"","webpack:///./src/service/user-authentication/index.ts","webpack:///./src/app.ts","webpack:///external \"reflect-metadata\"","webpack:///external \"body-parser\"","webpack:///external \"morgan\"","webpack:///external \"cors\"","webpack:///external \"express\"","webpack:///external \"path\"","webpack:///external \"socket.io\"","webpack:///./src/controller/index.ts","webpack:///./src/controller/user.controller.ts","webpack:///./src/service/user-authentication/user-authentication.ts","webpack:///external \"mongoose\"","webpack:///./src/models/index.ts","webpack:///./src/models/user.ts","webpack:///./src/constants/db.ts","webpack:///./src/service/services-registration.ts","webpack:///external \"inversify-inject-decorators\"","webpack:///./src/service/socket/index.ts","webpack:///./src/service/socket/socket.service.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","require","__export","inversify_express_utils_1","body_parser_1","__importDefault","morgan_1","cors_1","express_1","path_1","socket_io_1","services_registration_1","socket_1","server","InversifyExpressServer","CONTAINER","setConfig","app","use","default","urlencoded","extended","json","static","join","__dirname","application","build","port","process","env","PORT","serverInstance","listen","console","log","SocketService","getInstance","setSocket","inversify_1","user_authentication_1","UserController","userAuthenticationRepository","this","googleAuth","request","response","_a","body","email","accessToken","socialNetworksLogin","error","status","__decorate","httpPost","controller","__param","inject","UserAuthenticationRepository","mongoose_1","models_1","db_1","mongoose","Mongoose","userModel","model","USER_COLLECTION","Schema","USER_SCHEMA","connect","DB_URL","newUser","Promise","resolve","reject","save","data","_id","injectable","type","String","required","inversify_inject_decorators_1","Container","bind","to","lazyInject","clients","SocketService_1","instance","Error","socketIO","on","client","_this","push","onDisconnect","notifyAllClients","forEach","splice","indexOf"],"mappings":"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","file":"community-app-server.app.bundle.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 54ea09be0548ee64f76e","module.exports = require(\"inversify\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"inversify\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"inversify-express-utils\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"inversify-express-utils\"\n// module id = 1\n// module chunks = 0","export * from './user-authentication';\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/user-authentication/index.ts","import 'reflect-metadata';\r\n\r\nimport { InversifyExpressServer } from 'inversify-express-utils';\r\n\r\nimport bodyParser from 'body-parser';\r\nimport morgan from 'morgan';\r\nimport cors from 'cors';\r\nimport express from 'express';\r\nimport path from 'path';\r\nimport SocketIO from 'socket.io';\r\n\r\nimport './controller';\r\nimport { CONTAINER } from './service/services-registration';\r\nimport { SocketService } from 'service/socket';\r\n\r\nconst server = new InversifyExpressServer(CONTAINER);\r\n\r\nserver.setConfig((app) => {\r\n    app.use(morgan('dev'));\r\n    app.use(cors());\r\n    app.use(bodyParser.urlencoded({\r\n        extended: true\r\n    }));\r\n    app.use(bodyParser.json());\r\n\r\n    app.use(express.static(path.join(__dirname, '../../client/dist/client')));\r\n});\r\n\r\nconst application = server.build();\r\n\r\nconst port = process.env.PORT || 3030;\r\nconst serverInstance = application.listen(port, () => {\r\n    console.log('Press CTRL+C to stop\\n');\r\n});\r\n\r\nconst socketService: SocketService = SocketService.getInstance();\r\nsocketService.setSocket(SocketIO(serverInstance));\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.ts","module.exports = require(\"reflect-metadata\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"reflect-metadata\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cors\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 10\n// module chunks = 0","export * from './user.controller';\n\n\n// WEBPACK FOOTER //\n// ./src/controller/index.ts","import { controller, httpPost, httpGet } from 'inversify-express-utils';\r\nimport { Request, Response } from 'express';\r\nimport { inject } from 'inversify';\r\n\r\nimport { UserAuthenticationRepository } from 'service/user-authentication';\r\nimport { User } from '../models';\r\n\r\n@controller('/api/users')\r\nexport class UserController {\r\n\r\n  constructor(@inject(UserAuthenticationRepository) private userAuthenticationRepository: UserAuthenticationRepository) {\r\n  }\r\n\r\n  @httpPost('/google-auth')\r\n  public async googleAuth(request: Request, response: Response): Promise<Response | User> {\r\n    const { email, name, accessToken } = request.body;\r\n    try {\r\n      return this.userAuthenticationRepository.socialNetworksLogin(email, name, accessToken);\r\n    } catch (error) {\r\n      return response.status(500).json(error)\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/controller/user.controller.ts","\r\nimport { injectable } from 'inversify';\r\nimport { Mongoose, Schema, Model } from 'mongoose';\r\n\r\nimport { USER_SCHEMA, User } from '../../models';\r\nimport {\r\n    DB_URL,\r\n    USER_COLLECTION,\r\n} from '../../constants/db';\r\n\r\n@injectable()\r\nexport class UserAuthenticationRepository {\r\n\r\n    private mongoose: Mongoose = new Mongoose();\r\n    private userModel: Model<User> = this.mongoose.model<User>(USER_COLLECTION, new Schema(USER_SCHEMA));\r\n\r\n    constructor() {\r\n        this.mongoose.connect(DB_URL);\r\n    }\r\n\r\n    public async socialNetworksLogin(\r\n        email: string,\r\n        name: string,\r\n        accessToken: string,\r\n    ): Promise<User> {\r\n        const newUser: User = new this.userModel({ email, name, accessToken });\r\n\r\n        return new Promise<User>((resolve, reject) => {\r\n            newUser.save((error, data: User) => {\r\n                if (error) {\r\n                    reject(error);\r\n                    console.log(error);\r\n                } else {\r\n                    resolve(data);\r\n                    console.log(`Save ${data._id} booking fitness info success`);\r\n                }\r\n            });\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/user-authentication/user-authentication.ts","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 14\n// module chunks = 0","export * from './user';\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/index.ts","import * as mongoose from 'mongoose';\r\n\r\nexport interface User extends mongoose.Document {\r\n    email: string;\r\n    name: string;\r\n    accessToken: string;\r\n}\r\n\r\nexport const USER_SCHEMA = {\r\n    email: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    name: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    accessToken: {\r\n        type: String,\r\n        required: true\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.ts","// tslint:disable-next-line:max-line-length\r\nexport const DB_URL: string = 'mongodb://it-stone:g3QMmzLgTp1qGRXf2n89jVlc5iVxHGVeO9zTguvH8W90sdEeLB9BxEIe00F7XmDwEg1Z9DeXHe0SEEWmTSaabg%3D%3D@it-stone.documents.azure.com:10255/?ssl=true';\r\nexport const USER_COLLECTION: string = 'user';\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/constants/db.ts","import { Container } from 'inversify';\r\nimport getDecorators from 'inversify-inject-decorators';\r\n\r\nimport { UserAuthenticationRepository } from './user-authentication';\r\n\r\nexport const CONTAINER = new Container();\r\n\r\nCONTAINER.bind<UserAuthenticationRepository>(UserAuthenticationRepository).to(UserAuthenticationRepository);\r\n\r\nexport const inject = getDecorators(CONTAINER).lazyInject;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/services-registration.ts","module.exports = require(\"inversify-inject-decorators\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"inversify-inject-decorators\"\n// module id = 19\n// module chunks = 0","export * from './socket.service';\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/socket/index.ts","import { injectable } from 'inversify';\r\nimport SocketIO from 'socket.io';\r\n\r\nimport { inject } from '../services-registration';\r\n\r\n@injectable()\r\nexport class SocketService {\r\n  private static instance: SocketService;\r\n  private clients: SocketIO.Socket[] = [];\r\n\r\n  private constructor() {\r\n    if (SocketService.instance) {\r\n      throw new Error('You try to destroy singleton');\r\n    }\r\n  }\r\n\r\n  public static getInstance() {\r\n    if (!SocketService.instance) {\r\n      SocketService.instance = new SocketService();\r\n    }\r\n    return SocketService.instance;\r\n  }\r\n\r\n  public async setSocket(socketIO: SocketIO.Server): Promise<void | Response> {\r\n\r\n    socketIO.on('connection', (client: SocketIO.Socket) => {\r\n      this.clients.push(client);\r\n\r\n      client.on('disconnect', () => this.onDisconnect(client));\r\n      client.on('onStep', () => this.notifyAllClients())\r\n    });\r\n  }\r\n\r\n  public notifyAllClients(): void {\r\n    this.clients.forEach((client) => {\r\n      // client.emit(eventName, payload);\r\n    });\r\n  }\r\n\r\n  private onDisconnect(client: SocketIO.Socket): void {\r\n    this.clients.splice(this.clients.indexOf(client), 1);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/socket/socket.service.ts"],"sourceRoot":""}